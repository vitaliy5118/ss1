<?php $this->headTitle('Добавление ремонта');?>
<br>
<div class="repairs_info_block">
    <h4>
        Номер аппарата:&nbsp;<span class="repair_number"><?=$this->number?></span>
        &nbsp&nbsp&nbspНазвание аппарата:&nbsp;<span class="repair_number"><?=$this->name?></span>
    </h4>
</div>

<form id="form_spares" name="form_spares" method="post">
    <div class="main_spares_block">
        <div class="left_spares_block">
            <div id="spares_block">
                <p>Жалоба</p>
                <input class="form-control <?=$this->error['claim'] ?>" placeholder="введите жалобу" name="claim" type="input" value="<?=$this->claim; ?>">
            </div>
            <div id="spares_block">
                <p>Диагноз</p>
                <input  class="form-control <?=$this->error['diagnos'] ?>" placeholder="введите жалобу" name="diagnos" type="input" value="<?=$this->diagnos; ?>">
            </div>
            <div id="spares_block">
                <p>Работы</p>
                <input  class="form-control <?=$this->error['work'] ?>" placeholder="введите выполненные работы" name="work" type="input" value="<?=$this->work; ?>">
            </div>
            <div id="spares_block">
                <p>Статус</p>
                <select class="form-control" name="status">
                    <?php foreach ($this->status as $value) { ?>
                    <option <? if($this->status_ch==$value) {echo('selected ');} ?> value="<?=$value;?>"><?=$value;?></option>
                    <? } ?>
                </select>
            </div>
        </div>
        <div class="right_spares_block">
            <div id="spares_block">
                <p>Дополнительные запчасти</p>
                <input  class="form-control <?=$this->error['spares'] ?>" placeholder="введите запчасти" name="spares" type="input" value="<?=$this->spares; ?>">
            </div>
            <div id="spares_block">
                <p>Счетчик</p>
                <input  class="form-control <?=$this->error['counter'] ?>" placeholder="введите счетчик" name="counter" type="input" value="<?=$this->counter; ?>">
            </div>
            <div id="spares_block">
                <p>Комментарий</p>
                <input  class="form-control <?=$this->error['comments'] ?>" placeholder="введите комментарий" name="comments" type="input" value="<?=$this->comments; ?>">
            </div>
            <div id="spares_block">
                <br>
                <br>
                <br>
            </div>
        </div>
    </div>
    <p class="<?=$this->error_message?> message_in ">Необходимо заполнить все поля. Ввод только на русском языке.Если поле не используется ставте пометку 'Нет'</p>
    <br>
    <br>
        <button form="form_spares" class="btn btn-lg btn-success btn-block" type="submit">Добавить ремонт</button>
    <br>
    
    <div class="panel-body">
        <div class="dataTable_wrapper">
            <table width=100% class="table table-striped table-bordered table-hover" id="dataTables-example">
                <thead>
                    <tr>
                        <th>Фото</th>
                        <th>Серийный номер</th>
                        <th>Название</th>
                        <th>Остаток</th>
                        <th>К-во</th>
                        <th>CH</th>
                    </tr>
                </thead>
                <tbody>

                <?php
                 foreach ($this->warehouse as $rows) {
                ?>  <tr id='spares_row' class="gradeA">
                        <td id="spares_foto"><p><img src="/img/<?php echo $this->escape($rows['path']); ?>" width="30px" height="30px" ></p></td>
                        <td><?php echo $this->escape($rows['serial']); ?></td>
                        <td><?php echo $this->escape($rows['name']); ?></td>
                        <td id="spares_remain"><?php echo $this->escape($rows['remain']); ?></td>
                        <td id="spares_remain_check">
                            <input class=" check_spare_<?php echo $this->escape($rows['id']); ?> form-control <?=$this->error["{$this->escape($rows['id'])}"]; ?>" 
                                   name="<?php echo $this->escape($rows['id']); ?>"
                                   <? if(!$this->checked["{$this->escape($rows['id'])}"]) { echo ('disabled'); }?>
                                   type="input" 
                                   value="<?=$this->check_data["{$this->escape($rows['id'])}"];?>">
                        </td>
                        <td id="spares_check">
                            <input class="spare_check spare_check_<?php echo $this->escape($rows['id']); ?>"
                                   name="check_<?php echo $this->escape($rows['id']); ?>" type="checkbox" 
                                   value="<?php echo $this->escape($rows['id']); ?>" <?=$this->checked["{$this->escape($rows['id'])}"];?> 
                                   <? if($rows['remain']<1){echo ('disabled'); } ?>>
                        </td>
                    </tr> <? } ?>                            

                </tbody>
            </table>
        </div>
        <br>
        <button form="form_spares" class="btn btn-lg btn-success btn-block" type="submit">Добавить ремонт</button>
        <br>
    </div>
</form>